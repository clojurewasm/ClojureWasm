# T15.1: Port macros.clj test file

## Goal

Port threading macro tests from upstream `test/clojure/test_clojure/macros.clj`.

## Upstream Analysis

Source: `/Users/shota.508/Documents/OSS/clojure/test/clojure/test_clojure/macros.clj`

Tests:

1. `->test` - basic -> threading
2. `->>test` - basic ->> threading
3. `->metadata-test` - metadata preservation with ->
4. `->>metadata-test` - metadata preservation with ->>
5. `some->test` - some-> with nil short-circuit
6. `some->>test` - some->> with nil short-circuit
7. `cond->test` - cond-> conditional threading
8. `cond->>test` - cond->> conditional threading
9. `as->test` - as-> named binding
10. `threading-loop-recur` - threading with loop/recur

## JVM Dependencies

- None! All pure Clojure macros.
- All tests should port directly.

## Implementation Status

All threading macros already implemented in `src/clj/core.clj`:

- `->` (line 101)
- `->>` (line 110)
- `as->` (line 326)
- `some->` (line 331)
- `some->>` (line 353)
- `cond->` (line 375)
- `cond->>` (line 388)

## Plan

1. Create `test/clojure/macros.clj`
2. Port all 10 tests
3. Run tests, fix any failures
4. Update compat_test.yaml

## Log

- Created test/clojure/macros.clj with 10 tests ported from upstream
- All tests pass (all threading macros already implemented)
- Updated compat_test.yaml: +10 tests, +27 assertions

Tests ported:

1. ->test - basic -> threading
2. ->>test - basic ->> threading
3. ->metadata-test - metadata preservation (4 assertions)
4. ->>metadata-test - metadata preservation (4 assertions)
5. some->test - nil short-circuit (4 assertions)
6. some->>test - nil short-circuit (4 assertions)
7. cond->test - conditional threading (4 assertions)
8. cond->>test - conditional threading (4 assertions)
9. as->test - named binding (3 assertions)
10. threading-loop-recur - loop/recur integration (5 assertions)

No JVM dependencies - all tests ported directly without modification.
